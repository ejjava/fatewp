<!DOCTYPE html>
<html>
<head>
  <title>历史记录</title>
  <link rel="stylesheet" href="https://unpkg.com/mdui@1.0.2/dist/css/mdui.min.css">
</head>
<body>
  <h1>历史记录</h1>
  
  <button id="showHistoryButton" class="mdui-btn mdui-color-theme">查看历史记录</button>

  <div id="historyModal" class="mdui-dialog">
    <div class="mdui-dialog-title">历史记录</div>
    <div class="mdui-dialog-content">
      <ul id="historyList" class="mdui-list"></ul>
    </div>
    <div class="mdui-dialog-actions">
      <button id="closeModalButton" class="mdui-btn mdui-ripple">关闭</button>
    </div>
  </div>

  <a id="link" href="金额看" target="_blank" rel="noopener noreferrer">链接</a>

  <script src="https://unpkg.com/mdui@1.0.2/dist/js/mdui.min.js"></script>
  <script>
    // 获取历史记录列表元素
    const historyList = document.getElementById('historyList');

    // 获取按钮和弹窗元素
    const showHistoryButton = document.getElementById('showHistoryButton');
    const historyModal = new mdui.Dialog('#historyModal');
    const closeModalButton = document.getElementById('closeModalButton');

    // 页面加载时读取历史记录并显示
    window.addEventListener('DOMContentLoaded', () => {
      renderHistory();
    });

    // 渲染历史记录
    function renderHistory() {
      const historyData = JSON.parse(localStorage.getItem('historyData')) || [];
      historyList.innerHTML = '';

      historyData.forEach(item => {
        const listItem = document.createElement('li');
        listItem.classList.add('mdui-list-item');
        listItem.innerHTML = `<div class="mdui-list-item-content"><a href="${item}" target="_blank" rel="noopener noreferrer">${item}</a></div>`;
        historyList.appendChild(listItem);
      });
    }

    // 监听按钮点击事件，显示弹窗
    showHistoryButton.addEventListener('click', () => {
      historyModal.open();
    });

    // 监听关闭按钮点击事件，关闭弹窗
    closeModalButton.addEventListener('click', () => {
      historyModal.close();
    });

    // 监听链接点击事件，保存链接到历史记录
    const link = document.getElementById('link');
    link.addEventListener('click', (event) => {
      event.preventDefault();

      // 获取链接地址
      const linkUrl = link.getAttribute('href');

      // 创建历史记录项
      const historyItem = linkUrl;

      // 获取历史记录数据
      let historyData = JSON.parse(localStorage.getItem('historyData')) || [];
      historyData.push(historyItem);

      // 将历史记录保存到 localStorage
      localStorage.setItem('historyData', JSON.stringify(historyData));

      // 更新历史记录列表
      renderHistory();

      // 打开链接
      window.open(linkUrl, '_blank');
    });
  </script>
</body>
</html>
